# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash   
git clone https://gitlab.ozon.dev/maksimovis74/homework.git   
```
### 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –í—ã –Ω–µ –≤ –Ω–µ–π).  
```bash  
cd homework  
```  
### 3. –ò–∑ –¥–µ—Ä–∏–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã, —Å–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø–æ—Ä—Ç—É 8080:  
```bash      
make run-all   
```  
## üõ†–†–µ–∞–ª–∏–∑–∞—Ü–∏—è   
- –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ: Golang 1.23.1
- –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ http —Å–µ—Ä–≤–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ go
- –õ–æ–≥–µ—Ä zerolog  

# ‚úÖ –£—Å–ª–æ–≤–∏—è  
–£–º–µ–Ω—å—à–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ cart.list.
1. –†–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ä—É—á–∫–∏ –ø—Ä–æ–¥–∞–∫—Ç —Å–µ—Ä–≤–∏—Å–∞ ```cart/internal/business/service/cart/get_items.go``` ‚úÖ
2. –°–∞–º–∏–º –Ω–∞–ø–∏—Å–∞—Ç—å –∞–Ω–∞–ª–æ–≥ https://pkg.go.dev/golang.org/x/sync/errgroup –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ ```cart/internal/infra/errgroup/errgroup.go``` ‚úÖ
3. –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ - –æ—Ç–º–µ–Ω—è—Ç—å –≤—Å–µ —Ç–µ–∫—É—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É –∏–∑ errgroup ‚úÖ
4. –ü—Ä–∏ –æ–±—â–µ–Ω–∏–∏ —Å Product Service –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–º–∏—Ç 10 RPS –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ —Å—Ä–µ–¥—Å—Ç–≤–∞–º https://pkg.go.dev/golang.org/x/time/rate) ‚úÖ
5. –ì—Ä—É–ø–ø–∞ –∂–∏–≤–µ—Ç –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –≥—Ä—É–ø–ø–∞ –Ω–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ ‚úÖ
6. in-memory —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∑–∞—â–∏—Ç–∏—Ç—å –º—å—é—Ç–µ–∫—Å–∞–º–∏ ‚úÖ

# ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ  
1. –¢–µ—Å—Ç—ã –Ω–∞ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å in-memory —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ‚úÖ
2. –ì—Ä–µ–π—Å—Ñ—É–ª –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å signal.Notify (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ closer - `cart/internal/infra/closer/closer.go`) ‚úÖ
3. –ö–æ–Ω—Ç—Ä–æ–ª—å —É—Ç–µ—á–µ–∫ –≥–æ—Ä—É—Ç–∏–Ω —á–µ—Ä–µ–∑ https://github.com/uber-go/goleak (–ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Ç–µ—Å—Ç—ã —Å –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å—é) ‚úÖ
4. –ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ–π–∑–æ–≤ —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç—ã —Å —Ñ–ª–∞–≥–æ–º -race `make/service_make.mk` ‚úÖ
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (—Ç–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–∏–Ω—Ç–µ—Ä—ã paralleltest, tparallel) ‚úÖ
 # –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ü–µ–Ω–∞—Ä–∏—é

```json
POST http://localhost:8080/user/31337/cart/1076963
Content-Type: application/json

{
  "count": 1
}

### expected {} 200 OK; must add 1 item
```
```json
POST http://localhost:8080/user/31337/cart/1076963
Content-Type: application/json

{
  "count": 5
}
### expected {} 200 OK; must add 5 more item, 1076963 - must be 6 items

### result GET http://localhost:8080/user/31337/cart
{
    "items": [
        {
            "sku": 1076963,
            "name": "–¢–µ–æ—Ä–∏—è –Ω—Ä–∞–≤—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á—É–≤—Å—Ç–≤ | –°–º–∏—Ç –ê–¥–∞–º",
            "count": 6,
            "price": 3379
        }
    ],
    "total_price": 20274
}
```
```json
### add unknown sku to cart
POST http://localhost:8080/user/31337/cart/1076963000
Content-Type: application/json

{
  "count": 1
}
### expected {} 412 Precondition Failed; invalid sku

### result:
{
    "Message": "SKU –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–µ—Ä–≤–∏—Å–µ"
}
```
```json
### add another sku to cart
POST http://localhost:8080/user/31337/cart/1148162
Content-Type: application/json

{
  "count": 1
}
### expected {} 200 OK; must add 1 item

### result GET http://localhost:8080/user/31337/cart
{
    "items": [
        {
            "sku": 1148162,
            "name": "–ö—É–ª–∏–Ω–∞—Ä –ì—É—Ä–æ–≤",
            "count": 1,
            "price": 2931
        },
        {
            "sku": 1076963,
            "name": "–¢–µ–æ—Ä–∏—è –Ω—Ä–∞–≤—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á—É–≤—Å—Ç–≤ | –°–º–∏—Ç –ê–¥–∞–º",
            "count": 6,
            "price": 3379
        }
    ],
    "total_price": 23205
}
```
```json
### invalid user
POST http://localhost:8080/user/0/cart/1148162
Content-Type: application/json

{
  "count": 1
}
### expected {} 400 Bad Request

### result:
{
    "Message": "–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º (–±–æ–ª—å—à–µ –Ω—É–ª—è)"
}
```
```json
### invalid sku
POST http://localhost:8080/user/31337/cart/0
Content-Type: application/json

{
  "count": 1
}
### expected {} 400 Bad Request

### result:
{
    "Message": "SKU –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º (–±–æ–ª—å—à–µ –Ω—É–ª—è)"
}
```
```json
### invalid count
POST http://localhost:8080/user/31337/cart/1148162
Content-Type: application/json

{
  "count": 0
}
### expected {} 400 Bad Request

###result:
{
    "Message": "validation error: –ø–æ–ª–µ 'Count' –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ 0"
}
```
```json
### delete whole sku from cart
DELETE http://localhost:8080/user/31337/cart/1076963
Content-Type: application/json
### expected {} 200 OK; must delete item from cart

### result GET http://localhost:8080/user/31337/cart
{
    "items": [
        {
            "sku": 1148162,
            "name": "–ö—É–ª–∏–Ω–∞—Ä –ì—É—Ä–æ–≤",
            "count": 1,
            "price": 2931
        }
    ],
    "total_price": 2931
}
```
```json
### delete whole cart
DELETE http://localhost:8080/user/31337/cart
Content-Type: application/json
### expected {} 204 No Content; must delete cart

### result GET http://localhost:8080/user/31337
404 Not Found
```
```json
### get invalid list of cart
GET http://localhost:8080/user/0/cart
Content-Type: application/json
### 400 bad request

### result:
{
    "Message": "–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º (–±–æ–ª—å—à–µ –Ω—É–ª—è)"
}
```